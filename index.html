<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Sarmad Protocol | The Utility Economy</title>
    <link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700&family=Orbitron:wght@400;700&display=swap" rel="stylesheet">
    <style>
        :root { --main-color: #00ff88; --bg-color: #050505; --card-bg: #111; --text-color: #fff; }
        body { background-color: var(--bg-color); color: var(--text-color); font-family: 'Tajawal', sans-serif; margin: 0; padding: 20px; display: flex; flex-direction: column; align-items: center; min-height: 100vh; }
        
        /* Language & Header */
        .header { width: 100%; max-width: 480px; display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        .lang-btn { background: transparent; border: 1px solid var(--main-color); color: var(--main-color); padding: 5px 15px; cursor: pointer; border-radius: 20px; font-weight: bold; }
        
        /* Containers */
        .container { width: 100%; max-width: 450px; background: var(--card-bg); padding: 25px; border-radius: 15px; border: 1px solid #333; box-shadow: 0 0 25px rgba(0, 255, 136, 0.1); position: relative; overflow: hidden; }
        
        /* Typography */
        h1, h2, h3 { color: var(--main-color); margin-top: 0; }
        .logo { font-family: 'Orbitron', sans-serif; font-size: 2.2rem; letter-spacing: 3px; display: block; margin-bottom: 10px; text-align: center; text-shadow: 0 0 10px rgba(0,255,136,0.5); }
        .subtitle { text-align: center; color: #888; font-size: 0.9rem; margin-bottom: 25px; font-family: 'Orbitron', sans-serif; }

        /* Inputs & Buttons */
        input, button { width: 100%; padding: 14px; margin: 10px 0; border-radius: 8px; border: 1px solid #333; box-sizing: border-box; font-family: inherit; font-size: 1rem; }
        input { background: #222; color: #fff; text-align: center; transition: 0.3s; }
        input:focus { border-color: var(--main-color); outline: none; }
        button { background: var(--main-color); color: #000; font-weight: bold; cursor: pointer; transition: 0.3s; border: none; text-transform: uppercase; letter-spacing: 1px; }
        button:hover { background: #00cc6a; box-shadow: 0 0 15px rgba(0,255,136,0.4); }
        button:disabled { background: #444; color: #888; cursor: not-allowed; box-shadow: none; }

        /* Sections */
        .hidden { display: none; }
        .scroll-box { height: 150px; overflow-y: scroll; background: #1a1a1a; padding: 15px; text-align: start; border: 1px solid #444; font-size: 0.85rem; margin-bottom: 15px; border-radius: 8px; line-height: 1.6; }
        
        /* Wallet Box */
        .wallet-container { background: #222; padding: 15px; border-radius: 8px; margin: 15px 0; text-align: center; border: 1px dashed var(--main-color); }
        .wallet-address { font-family: monospace; word-break: break-all; color: var(--main-color); margin: 10px 0; font-size: 0.9rem; user-select: all; }
        .copy-hint { font-size: 0.75rem; color: #666; }

        /* Status Badges */
        .status-badge { display: inline-block; padding: 8px 20px; border-radius: 20px; font-size: 0.9rem; margin-top: 15px; font-weight: bold; }
        .pending { background: rgba(255, 152, 0, 0.2); color: #ff9800; border: 1px solid #ff9800; }
        .approved { background: rgba(0, 255, 136, 0.2); color: #00ff88; border: 1px solid #00ff88; }
        
        #recaptcha-container { margin: 15px auto; display: flex; justify-content: center; }
        
        /* Loading Spinner */
        .loader { border: 3px solid #333; border-top: 3px solid var(--main-color); border-radius: 50%; width: 20px; height: 20px; animation: spin 1s linear infinite; display: inline-block; vertical-align: middle; margin-right: 10px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>

    <div class="header">
        <div style="width: 50px;"></div> <button class="lang-btn" onclick="toggleLanguage()" id="langBtn">English</button>
    </div>

    <div class="container">
        <span class="logo">SARMAD</span>
        <div class="subtitle">PROTOCOL $SRMD</div>
        
        <div id="login-section">
            <h3 id="txt_login_title">Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠÙ† Ø§Ù„Ø£ÙˆØ§Ø¦Ù„</h3>
            <p style="color:#888; font-size:0.9rem;" id="txt_login_desc">Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±</p>
            
            <input type="tel" id="phoneNumber" placeholder="+9665xxxxxxxx" dir="ltr">
            <div id="recaptcha-container"></div>
            
            <button onclick="sendOTP()" id="sendBtn">
                <span id="txt_send_code">Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚</span>
            </button>
            
            <div id="otp-group" class="hidden">
                <input type="text" id="otpCode" placeholder="xxxxxx" maxlength="6" style="letter-spacing: 5px;">
                <button onclick="verifyOTP()" id="txt_verify">Ø¯Ø®ÙˆÙ„</button>
            </div>
        </div>

        <div id="agreement-section" class="hidden">
            <h3 id="txt_saft_title">ğŸ“œ Ø§ØªÙØ§Ù‚ÙŠØ© SAFT</h3>
            <div class="scroll-box">
                <div id="saft_content_ar">
                    <p><strong>1. Ø·Ø¨ÙŠØ¹Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹:</strong> ÙŠÙ‚Ø± Ø§Ù„Ø·Ø±Ù Ø§Ù„Ø«Ø§Ù†ÙŠ Ø¨Ø£Ù† Ø¹Ù…Ù„Ø© Ø³Ø±Ù…Ø¯ (Utility Token) Ù‡ÙŠ Ø£Ø¯Ø§Ø© ØªÙ‚Ù†ÙŠØ© Ù„Ù„Ø´Ø¨ÙƒØ© ÙˆÙ„ÙŠØ³Øª ÙˆØ±Ù‚Ø© Ù…Ø§Ù„ÙŠØ© Ø£Ùˆ Ø³Ù‡Ù… Ø´Ø±ÙƒØ©.</p>
                    <p><strong>2. Ø§Ù„Ù…Ø®Ø§Ø·Ø±:</strong> Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙÙŠ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ© Ø¹Ø§Ù„ÙŠ Ø§Ù„Ù…Ø®Ø§Ø·Ø±ØŒ ÙˆØ³Ø¹Ø± Ø§Ù„Ø¹Ù…Ù„Ø© ÙŠØ®Ø¶Ø¹ Ù„Ù„Ø¹Ø±Ø¶ ÙˆØ§Ù„Ø·Ù„Ø¨ Ø§Ù„Ø­Ø± Ø¨Ø¹Ø¯ Ø§Ù„Ø¥Ø·Ù„Ø§Ù‚.</p>
                    <p><strong>3. Ø§Ù„ØªÙˆØ²ÙŠØ¹:</strong> ÙŠØªÙ… ØªÙˆØ²ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„Ø§Øª ØªØ¯Ø±ÙŠØ¬ÙŠØ§Ù‹ Ø¨Ø¹Ø¯ Ø¥Ø·Ù„Ø§Ù‚ Ø§Ù„Ø´Ø¨ÙƒØ© Ø§Ù„Ø±Ø¦ÙŠØ³ÙŠØ© (Mainnet) Ù„Ø¶Ù…Ø§Ù† Ø§Ø³ØªÙ‚Ø±Ø§Ø± Ø§Ù„Ø³ÙˆÙ‚.</p>
                    <p><strong>4. Ø§Ù„Ø£Ù…ÙˆØ§Ù„:</strong> Ø§Ù„Ù…Ø¨Ø§Ù„Øº Ø§Ù„Ù…Ø¯ÙÙˆØ¹Ø© ØªØ³ØªØ®Ø¯Ù… Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ø¨Ù†ÙŠØ© Ø§Ù„ØªØ­ØªÙŠØ© ÙˆØºÙŠØ± Ù‚Ø§Ø¨Ù„Ø© Ù„Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯.</p>
                </div>
                <div id="saft_content_en" class="hidden">
                    <p><strong>1. Nature of Project:</strong> You acknowledge that SRMD is a Utility Token for network processing, not a security.</p>
                    <p><strong>2. Risks:</strong> Crypto investments are high-risk. Price is subject to free market supply/demand.</p>
                    <p><strong>3. Vesting:</strong> Tokens are distributed gradually after Mainnet launch to ensure stability.</p>
                    <p><strong>4. Funds:</strong> Contributed funds are used for development and are non-refundable.</p>
                </div>
            </div>
            <label style="font-size:0.9rem; cursor:pointer; display: flex; align-items: center; justify-content: start; gap: 10px;">
                <input type="checkbox" id="agreeCheck" style="width:auto; margin:0;"> 
                <span id="txt_agree_label">Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…</span>
            </label>
            <button onclick="acceptTerms()" id="agreeBtn" disabled>
                <span id="txt_continue">Ù…ØªØ§Ø¨Ø¹Ø©</span>
            </button>
        </div>

        <div id="dashboard-section" class="hidden">
            <h3 id="txt_dash_title">Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±</h3>
            
            <div style="text-align: center; margin: 30px 0;">
                <h1 id="userBalance" style="font-size: 2.5rem; margin-bottom: 5px;">0 SRMD</h1>
                <p style="color:#aaa; margin:0;"><span id="txt_est_val">Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ©:</span> <span id="usdValue">$0.00</span></p>
                <div id="statusMsg"></div>
            </div>

            <hr style="border-color:#333; margin: 25px 0;">

            <div id="deposit-form">
                <h4 id="txt_buy_title">Ø´Ø±Ø§Ø¡ Ø±ØµÙŠØ¯ Ø¬Ø¯ÙŠØ¯ (Otc Deal)</h4>
                <p style="font-size:0.85rem; color:#888;">
                    <span id="txt_price">Ø³Ø¹Ø± Ø§Ù„Ø·Ø±Ø­ Ø§Ù„Ø£ÙˆÙ„ÙŠ:</span> <strong style="color:#fff">$0.05</strong>
                </p>
                
                <p style="font-size:0.8rem;" id="txt_send_instruct">Ø£Ø±Ø³Ù„ USDT (Ø´Ø¨ÙƒØ© TRC20) Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:</p>
                
                <div class="wallet-container">
                    <div class="wallet-address" id="walletAddr">TH9uvbgRL4gG2Ad3255hWTHco6jQt13G6N</div> 
                    <div class="copy-hint" id="txt_click_copy">(Ø§Ø¶ØºØ· Ù„Ù†Ø³Ø® Ø§Ù„Ø¹Ù†ÙˆØ§Ù†)</div>
                </div>
                
                <input type="text" id="txId" placeholder="Ø§Ù„ØµÙ‚ Ø±Ù‚Ù… Ø§Ù„Ø¹Ù…Ù„ÙŠØ© (TXID/Hash) Ù‡Ù†Ø§">
                <button onclick="submitTransaction()" id="btn_confirm_tx">ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„</button>
            </div>
        </div>
    </div>

    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

    <script>
        // --- 1. CONFIGURATION ---
        const firebaseConfig = {
            apiKey: "AIzaSyBVyEPs_xvz9Oryk-jpLev4ja7Sb1P6RaM",
            authDomain: "sarmad-web.firebaseapp.com",
            projectId: "sarmad-web",
            storageBucket: "sarmad-web.firebasestorage.app",
            messagingSenderId: "687271413195",
            appId: "1:687271413195:web:f9564027c56ed0efb7e24e"
        };

        // Initialize Firebase
        firebase.initializeApp(firebaseConfig);
        const auth = firebase.auth();
        const db = firebase.firestore();
        
        // --- 2. LANGUAGE SYSTEM ---
        let currentLang = 'ar';
        const texts = {
            ar: {
                login_title: "Ø¨ÙˆØ§Ø¨Ø© Ø§Ù„Ù…Ø¤Ø³Ø³ÙŠÙ† Ø§Ù„Ø£ÙˆØ§Ø¦Ù„",
                login_desc: "Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙÙƒ Ù„Ù„ÙˆØµÙˆÙ„ Ø¥Ù„Ù‰ Ù„ÙˆØ­Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±",
                send_code: "Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚",
                verify: "Ø¯Ø®ÙˆÙ„",
                saft_title: "ğŸ“œ Ø§ØªÙØ§Ù‚ÙŠØ© SAFT",
                agree_label: "Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ø£Ø­ÙƒØ§Ù…",
                continue: "Ù…ØªØ§Ø¨Ø¹Ø©",
                dash_title: "Ù…Ø­ÙØ¸Ø© Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±",
                est_val: "Ø§Ù„Ù‚ÙŠÙ…Ø© Ø§Ù„ØªÙ‚Ø¯ÙŠØ±ÙŠØ©:",
                buy_title: "Ø´Ø±Ø§Ø¡ Ø±ØµÙŠØ¯ Ø¬Ø¯ÙŠØ¯",
                price: "Ø³Ø¹Ø± Ø§Ù„Ø·Ø±Ø­ Ø§Ù„Ø£ÙˆÙ„ÙŠ:",
                send_instruct: "Ø£Ø±Ø³Ù„ USDT (Ø´Ø¨ÙƒØ© TRC20) Ø¥Ù„Ù‰ Ø§Ù„Ø¹Ù†ÙˆØ§Ù†:",
                click_copy: "(Ø§Ø¶ØºØ· Ù„Ù†Ø³Ø® Ø§Ù„Ø¹Ù†ÙˆØ§Ù†)",
                confirm_tx: "ØªØ£ÙƒÙŠØ¯ Ø§Ù„ØªØ­ÙˆÙŠÙ„",
                alert_sent: "ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ù…Ø²",
                alert_error: "Ø­Ø¯Ø« Ø®Ø·Ø£: ",
                alert_verify_fail: "Ø§Ù„Ø±Ù…Ø² ØºÙŠØ± ØµØ­ÙŠØ­",
                alert_tx_sent: "ØªÙ… Ø§Ø³ØªÙ„Ø§Ù… Ø§Ù„Ø·Ù„Ø¨! Ø³ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© Ø§Ù„Ø­ÙˆØ§Ù„Ø© ÙˆØªØ­Ø¯ÙŠØ« Ø§Ù„Ø±ØµÙŠØ¯ Ø®Ù„Ø§Ù„ 24 Ø³Ø§Ø¹Ø©.",
                alert_copy: "ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø¹Ù†ÙˆØ§Ù†!",
                badge_pending: "Ø¬Ø§Ø±ÙŠ Ù…Ø±Ø§Ø¬Ø¹Ø© Ø¹Ù…Ù„ÙŠØ© Ø§Ù„ØªØ­ÙˆÙŠÙ„...",
                badge_approved: "ØªÙ… Ø§Ø¹ØªÙ…Ø§Ø¯ Ø§Ù„Ø±ØµÙŠØ¯ âœ…"
            },
            en: {
                login_title: "Early Founders Gate",
                login_desc: "Enter your phone number to access dashboard",
                send_code: "Send Verification Code",
                verify: "Login",
                saft_title: "ğŸ“œ SAFT Agreement",
                agree_label: "I agree to Terms & Conditions",
                continue: "Continue",
                dash_title: "Investment Wallet",
                est_val: "Est. Value:",
                buy_title: "Buy Pre-Sale Allocation",
                price: "Pre-Sale Price:",
                send_instruct: "Send USDT (TRC20) to this address:",
                click_copy: "(Tap to copy address)",
                confirm_tx: "Confirm Transaction",
                alert_sent: "Code sent successfully",
                alert_error: "Error: ",
                alert_verify_fail: "Invalid Code",
                alert_tx_sent: "Request received! We will verify TXID and update balance within 24h.",
                alert_copy: "Address Copied!",
                badge_pending: "Transaction under review...",
                badge_approved: "Balance Confirmed âœ…"
            }
        };

        function toggleLanguage() {
            currentLang = currentLang === 'ar' ? 'en' : 'ar';
            document.documentElement.dir = currentLang === 'ar' ? 'rtl' : 'ltr';
            document.documentElement.lang = currentLang;
            document.getElementById('langBtn').innerText = currentLang === 'ar' ? 'English' : 'Ø¹Ø±Ø¨ÙŠ';
            
            // Update Texts
            const t = texts[currentLang];
            document.getElementById('txt_login_title').innerText = t.login_title;
            document.getElementById('txt_login_desc').innerText = t.login_desc;
            document.getElementById('txt_send_code').innerText = t.send_code;
            document.getElementById('txt_verify').innerText = t.verify;
            document.getElementById('txt_saft_title').innerText = t.saft_title;
            document.getElementById('txt_agree_label').innerText = t.agree_label;
            document.getElementById('txt_continue').innerText = t.continue;
            document.getElementById('txt_dash_title').innerText = t.dash_title;
            document.getElementById('txt_est_val').innerText = t.est_val;
            document.getElementById('txt_buy_title').innerText = t.buy_title;
            document.getElementById('txt_price').innerText = t.price;
            document.getElementById('txt_send_instruct').innerText = t.send_instruct;
            document.getElementById('txt_click_copy').innerText = t.click_copy;
            document.getElementById('btn_confirm_tx').innerText = t.confirm_tx;
            document.getElementById('phoneNumber').placeholder = currentLang === 'ar' ? '+9665xxxxxxxx' : '+1xxxxxxxxxx';

            // Toggle SAFT Content
            if(currentLang === 'ar') {
                document.getElementById('saft_content_ar').classList.remove('hidden');
                document.getElementById('saft_content_en').classList.add('hidden');
            } else {
                document.getElementById('saft_content_ar').classList.add('hidden');
                document.getElementById('saft_content_en').classList.remove('hidden');
            }
        }

        // --- 3. AUTH LOGIC ---
        let confirmationResult;
        let currentUser;

        window.onload = function() {
            window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
                'size': 'normal'
            });
            
            auth.onAuthStateChanged(user => {
                if (user) {
                    currentUser = user;
                    loadUserData();
                }
            });
        };

        function sendOTP() {
            const phone = document.getElementById('phoneNumber').value;
            const appVerifier = window.recaptchaVerifier;
            auth.signInWithPhoneNumber(phone, appVerifier)
                .then((result) => {
                    confirmationResult = result;
                    document.getElementById('sendBtn').classList.add('hidden');
                    document.getElementById('otp-group').classList.remove('hidden');
                    alert(texts[currentLang].alert_sent);
                }).catch((error) => { console.error(error); alert(texts[currentLang].alert_error + error.message); });
        }

        function verifyOTP() {
            const code = document.getElementById('otpCode').value;
            confirmationResult.confirm(code).then((result) => {
                currentUser = result.user;
                loadUserData();
            }).catch((error) => { alert(texts[currentLang].alert_verify_fail); });
        }

        // --- 4. DATA LOGIC ---
        async function loadUserData() {
            document.getElementById('login-section').classList.add('hidden');
            
            const docRef = db.collection('investors').doc(currentUser.phoneNumber);
            const doc = await docRef.get();

            if (!doc.exists) {
                document.getElementById('agreement-section').classList.remove('hidden');
            } else {
                const data = doc.data();
                if(!data.agreedToTerms) {
                    document.getElementById('agreement-section').classList.remove('hidden');
                } else {
                    showDashboard(data);
                }
            }
        }

        document.getElementById('agreeCheck').addEventListener('change', function() {
            document.getElementById('agreeBtn').disabled = !this.checked;
        });

        function acceptTerms() {
            db.collection('investors').doc(currentUser.phoneNumber).set({
                phone: currentUser.phoneNumber,
                agreedToTerms: true,
                joinedAt: firebase.firestore.FieldValue.serverTimestamp(),
                balance: 0,
                status: 'new'
            }, { merge: true }).then(() => {
                document.getElementById('agreement-section').classList.add('hidden');
                showDashboard({balance: 0, status: 'new'});
            });
        }

        function showDashboard(data) {
            document.getElementById('dashboard-section').classList.remove('hidden');
            const balance = data.balance || 0;
            document.getElementById('userBalance').innerText = balance + " SRMD";
            
            // Calculate USD Value (Balance * 0.05 Pre-sale price)
            // Or Future Value (Balance * 0.50) -> Let's show Pre-sale value now
            let usdVal = (balance * 0.05).toFixed(2); 
            document.getElementById('usdValue').innerText = "$" + usdVal;
            
            const statusDiv = document.getElementById('statusMsg');
            if (data.lastTxId && data.status === 'pending') {
                statusDiv.innerHTML = `<span class="status-badge pending">${texts[currentLang].badge_pending}</span>`;
            } else if (data.status === 'approved') {
                statusDiv.innerHTML = `<span class="status-badge approved">${texts[currentLang].badge_approved}</span>`;
            }
        }

        function submitTransaction() {
            const txId = document.getElementById('txId').value;
            if(txId.length < 5) return;
            
            db.collection('investors').doc(currentUser.phoneNumber).update({
                lastTxId: txId,
                status: 'pending',
                updatedAt: firebase.firestore.FieldValue.serverTimestamp()
            }).then(() => {
                alert(texts[currentLang].alert_tx_sent);
                location.reload();
            });
        }

        // Copy Wallet Logic
        document.querySelector('.wallet-container').addEventListener('click', function() {
            const addr = document.getElementById('walletAddr').innerText;
            navigator.clipboard.writeText(addr).then(() => {
                alert(texts[currentLang].alert_copy);
            });
        });
    </script>

</body>
</html>