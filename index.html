<!DOCTYPE html>
<html lang="ar" dir="rtl" id="main-html">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Sarmad Protocol | Ø§ØªÙØ§Ù‚ÙŠØ© Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;500;700&family=Orbitron:wght@700&display=swap" rel="stylesheet">
<style>
:root {
    --gold: #d4af37;
    --bg: #0a0a0a;
    --card: #111;
    --text: #fff;
    --grey: #888;
    --green: #00ff88;
    --red: #ff4444;
    --orange: #ffa500;
    --border: #222;
    --glass: rgba(255, 255, 255, 0.05);
}

* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    background: var(--bg);
    color: var(--text);
    font-family: 'Tajawal', sans-serif;
    line-height: 1.8;
    overflow-x: hidden;
}

/* Agreement Page Styles */
.agreement-page {
    min-height: 100vh;
    padding: 20px;
}

.agreement-container {
    max-width: 800px;
    margin: 0 auto;
}

.agreement-header {
    text-align: center;
    padding: 20px 20px;
    border-bottom: 1px solid var(--border);
    margin-bottom: 30px;
}

.agreement-logo {
    font-family: 'Orbitron', sans-serif;
    font-size: 2rem;
    color: var(--gold);
    margin-bottom: 10px;
    letter-spacing: 3px;
}

.agreement-subtitle {
    color: var(--grey);
    font-size: 1rem;
}

.version-badge {
    display: inline-block;
    background: rgba(212, 175, 55, 0.1);
    border: 1px solid var(--gold);
    color: var(--gold);
    padding: 4px 12px;
    border-radius: 12px;
    font-size: 0.75rem;
    margin-top: 10px;
    font-family: 'Orbitron', sans-serif;
}

.lang-switch {
    position: fixed;
    top: 20px;
    left: 20px;
    background: transparent;
    border: 1px solid var(--gold);
    color: var(--gold);
    padding: 8px 16px;
    border-radius: 20px;
    cursor: pointer;
    font-family: inherit;
    font-size: 0.85rem;
    z-index: 100;
    transition: all 0.3s;
}

.lang-switch:hover {
    background: rgba(212, 175, 55, 0.1);
}

/* --- Enhanced Carousel Styles --- */
.sarmad-carousel-section {
    background-color: #000000;
    width: 100%;
    padding: 30px 0;
    display: flex;
    justify-content: center;
    align-items: center;
    margin-bottom: 30px;
}

.carousel-wrapper {
    position: relative;
    width: 100%;
    max-width: 900px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 20px;
    padding: 0 70px;
}

.carousel-container {
    width: 100%;
    max-width: 700px;
    position: relative;
    border: 2px solid #D4AF37;
    border-radius: 15px;
    box-shadow: 0 0 30px rgba(212, 175, 55, 0.2);
    overflow: hidden;
    background: #000;
    direction: ltr;
}

.carousel-slide {
    display: flex;
    width: 100%;
    height: 100%;
    transition: transform 0.5s ease-in-out;
}

.carousel-img {
    width: 100%;
    min-width: 100%;
    height: auto;
    display: block;
    cursor: pointer;
    object-fit: cover;
}

/* Navigation Buttons - Ø¹Ù„Ù‰ Ø§Ù„Ø¬Ø§Ù†Ø¨ÙŠÙ† */
.nav-btn {
    position: absolute;
    top: 50%;
    transform: translateY(-50%);
    background-color: rgba(0, 0, 0, 0.8);
    color: #D4AF37;
    border: 2px solid #D4AF37;
    font-size: 28px;
    width: 55px;
    height: 55px;
    cursor: pointer;
    z-index: 10;
    border-radius: 50%;
    transition: all 0.3s ease;
    outline: none;
    user-select: none;
    display: flex;
    align-items: center;
    justify-content: center;
}

.nav-btn:hover {
    background-color: #D4AF37;
    color: #000;
    box-shadow: 0 0 25px rgba(212, 175, 55, 1);
    transform: translateY(-50%) scale(1.1);
}

.nav-btn:active {
    transform: translateY(-50%) scale(0.95);
}

.prev-btn { 
    left: 0;
}

.next-btn { 
    right: 0;
}

/* Ù…Ø¤Ø´Ø±Ø§Øª Ø§Ù„Ø³Ù„Ø§ÙŠØ¯ */
.carousel-indicators {
    position: absolute;
    bottom: 15px;
    left: 50%;
    transform: translateX(-50%);
    display: flex;
    gap: 8px;
    z-index: 5;
}

.indicator-dot {
    width: 10px;
    height: 10px;
    border-radius: 50%;
    background-color: rgba(255, 255, 255, 0.5);
    border: 1px solid #D4AF37;
    cursor: pointer;
    transition: all 0.3s ease;
}

.indicator-dot.active {
    background-color: #D4AF37;
    width: 30px;
    border-radius: 5px;
}

.indicator-dot:hover {
    background-color: rgba(212, 175, 55, 0.7);
}

/* Lightbox Styles */
.lightbox-overlay {
    display: none;
    position: fixed;
    z-index: 9999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.95);
    justify-content: center;
    align-items: center;
    backdrop-filter: blur(5px);
}

.lightbox-content {
    max-width: 95%;
    max-height: 90%;
    border: 2px solid #D4AF37;
    border-radius: 8px;
    box-shadow: 0 0 50px rgba(212, 175, 55, 0.3);
    animation: zoomIn 0.3s;
}

.close-btn {
    position: absolute;
    top: 20px;
    right: 35px;
    color: #D4AF37;
    font-size: 50px;
    font-weight: bold;
    cursor: pointer;
    z-index: 10000;
    line-height: 1;
}

.close-btn:hover { color: #fff; }

@keyframes zoomIn {
    from {transform: scale(0.8); opacity: 0;}
    to {transform: scale(1); opacity: 1;}
}

/* Responsive Design */
@media (max-width: 768px) {
    .carousel-wrapper {
        padding: 0 15px;
    }
    
    .nav-btn {
        width: 45px;
        height: 45px;
        font-size: 22px;
    }
    
    .prev-btn {
        left: -5px;
    }
    
    .next-btn {
        right: -5px;
    }
}

@media (max-width: 480px) {
    .nav-btn {
        width: 40px;
        height: 40px;
        font-size: 20px;
    }
    
    .prev-btn {
        left: -10px;
    }
    
    .next-btn {
        right: -10px;
    }
}

.content-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 30px;
    margin-bottom: 20px;
}

.section-title {
    color: var(--gold);
    font-size: 1.2rem;
    font-weight: 700;
    margin-bottom: 20px;
    padding-bottom: 10px;
    border-bottom: 1px solid var(--border);
}

.terms-list {
    list-style: none;
}

.terms-list li {
    padding: 15px 0;
    border-bottom: 1px solid var(--border);
    color: #ccc;
    font-size: 0.95rem;
    position: relative;
    padding-right: 30px;
}

.terms-list li:last-child {
    border-bottom: none;
}

.terms-list li:before {
    content: "â€¢";
    color: var(--gold);
    position: absolute;
    right: 0;
    font-size: 1.5rem;
    line-height: 1.2;
}

.terms-list li strong {
    color: var(--text);
    display: block;
    margin-bottom: 5px;
}

.highlight-box {
    background: rgba(255, 68, 68, 0.05);
    border: 1px solid rgba(255, 68, 68, 0.2);
    border-radius: 12px;
    padding: 20px;
    margin: 20px 0;
}

.highlight-title {
    color: var(--red);
    font-weight: 700;
    margin-bottom: 10px;
    font-size: 0.95rem;
}

.agree-section {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 25px;
    margin-bottom: 20px;
}

.checkbox-container {
    display: flex;
    align-items: flex-start;
    gap: 15px;
    cursor: pointer;
}

.checkbox-container input[type="checkbox"] {
    width: 24px;
    height: 24px;
    accent-color: var(--gold);
    margin-top: 3px;
    cursor: pointer;
    flex-shrink: 0;
}

.checkbox-text {
    color: #ccc;
    font-size: 0.95rem;
    line-height: 1.6;
}

.checkbox-text strong {
    color: var(--text);
}

.agreement-btn {
    width: 100%;
    padding: 18px;
    background: var(--gold);
    color: #000;
    border: none;
    border-radius: 12px;
    font-size: 1.1rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s;
    font-family: inherit;
}

.agreement-btn:hover {
    background: #e6c04a;
    box-shadow: 0 0 20px rgba(212, 175, 55, 0.5);
}

.agreement-btn:disabled {
    background: var(--grey);
    cursor: not-allowed;
    opacity: 0.5;
}

/* ===== WALLET APP STYLES ===== */
.wallet-app {
    display: none;
    min-height: 100vh;
    background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
}

#walletApp.wallet-app {
    display: block !important;
}

.hidden {
    display: none !important;
}

.header {
    background: var(--card);
    border-bottom: 1px solid var(--border);
    padding: 15px 20px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.logo-section {
    display: flex;
    align-items: center;
    gap: 15px;
}

.logo-text {
    font-family: 'Orbitron', sans-serif;
    font-size: 1.3rem;
    color: var(--gold);
    letter-spacing: 2px;
}

.user-section {
    display: flex;
    align-items: center;
    gap: 12px;
}

.user-icon {
    width: 35px;
    height: 35px;
    background: linear-gradient(135deg, var(--gold), #e6c04a);
    border-radius: 50%;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.1rem;
}

.container {
    max-width: 1200px;
    margin: 0 auto;
    padding: 20px;
}

.card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 25px;
    margin-bottom: 20px;
}

.card-title {
    color: var(--gold);
    font-size: 1.2rem;
    font-weight: 700;
    margin-bottom: 20px;
    display: flex;
    align-items: center;
    gap: 10px;
}

.card-title::before {
    content: "â—†";
    color: var(--gold);
    font-size: 0.8rem;
}

.balance-display {
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(212, 175, 55, 0.05));
    border: 1px solid var(--gold);
    border-radius: 12px;
    padding: 25px;
    text-align: center;
    margin-bottom: 15px;
}

.balance-amount {
    font-size: 3rem;
    font-weight: 700;
    color: var(--gold);
    font-family: 'Orbitron', sans-serif;
}

.balance-label {
    color: var(--grey);
    font-size: 0.9rem;
    margin-top: 5px;
}

.usd-value {
    font-size: 1.3rem;
    color: var(--text);
    margin-top: 10px;
}

.info-box {
    background: rgba(0, 255, 136, 0.05);
    border: 1px solid rgba(0, 255, 136, 0.2);
    border-radius: 10px;
    padding: 15px;
    margin-bottom: 15px;
}

.info-box p {
    color: var(--green);
    font-size: 0.9rem;
    margin-bottom: 8px;
}

.wallet-address {
    background: var(--bg);
    border: 1px dashed var(--border);
    border-radius: 8px;
    padding: 12px;
    font-family: 'Courier New', monospace;
    color: var(--gold);
    font-size: 0.85rem;
    word-break: break-all;
    margin-bottom: 10px;
}

.copy-btn {
    width: 100%;
    padding: 12px;
    background: var(--green);
    color: #000;
    border: none;
    border-radius: 8px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.3s;
}

.copy-btn:hover {
    background: #00ff99;
    box-shadow: 0 0 15px rgba(0, 255, 136, 0.3);
}

.input-group {
    margin-bottom: 15px;
}

.input-group label {
    display: block;
    color: var(--grey);
    margin-bottom: 8px;
    font-size: 0.9rem;
}

.input-group input,
.input-group textarea {
    width: 100%;
    padding: 12px;
    background: var(--bg);
    border: 1px solid var(--border);
    border-radius: 8px;
    color: var(--text);
    font-family: inherit;
    font-size: 0.95rem;
}

.input-group input:focus,
.input-group textarea:focus {
    outline: none;
    border-color: var(--gold);
    box-shadow: 0 0 10px rgba(212, 175, 55, 0.2);
}

.submit-btn {
    width: 100%;
    padding: 15px;
    background: var(--gold);
    color: #000;
    border: none;
    border-radius: 10px;
    font-size: 1.05rem;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s;
}

.submit-btn:hover {
    background: #e6c04a;
    box-shadow: 0 0 20px rgba(212, 175, 55, 0.4);
}

.submit-btn:disabled {
    background: var(--grey);
    cursor: not-allowed;
    opacity: 0.5;
}

.history-table {
    width: 100%;
    border-collapse: collapse;
}

.history-table th {
    background: var(--bg);
    color: var(--gold);
    padding: 12px;
    text-align: right;
    font-weight: 600;
    border-bottom: 2px solid var(--border);
}

.history-table td {
    padding: 15px 12px;
    border-bottom: 1px solid var(--border);
    color: var(--text);
}

.history-table tr:last-child td {
    border-bottom: none;
}

.st-pending {
    color: var(--orange);
    font-weight: 600;
}

.st-approved {
    color: var(--green);
    font-weight: 600;
}

.st-rejected {
    color: var(--red);
    font-weight: 600;
}

.txid-preview {
    font-family: 'Courier New', monospace;
    font-size: 0.85rem;
    color: var(--grey);
}

.reason-text {
    display: block;
    font-size: 0.75rem;
    color: var(--grey);
    margin-top: 3px;
}

.empty-state {
    text-align: center;
    padding: 40px 20px;
    color: var(--grey);
}

.empty-state p {
    font-size: 1.1rem;
    margin-bottom: 10px;
}

.empty-state small {
    color: var(--grey);
    opacity: 0.7;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
}

.stat-card {
    background: linear-gradient(135deg, rgba(212, 175, 55, 0.1), rgba(212, 175, 55, 0.05));
    border: 1px solid var(--gold);
    border-radius: 12px;
    padding: 20px;
    text-align: center;
}

.stat-value {
    font-size: 2rem;
    font-weight: 700;
    color: var(--gold);
    font-family: 'Orbitron', sans-serif;
}

.stat-label {
    color: var(--grey);
    font-size: 0.85rem;
    margin-top: 5px;
}

.refresh-btn {
    padding: 10px 20px;
    background: transparent;
    border: 1px solid var(--gold);
    color: var(--gold);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 0.9rem;
}

.refresh-btn:hover {
    background: rgba(212, 175, 55, 0.1);
}

.logout-btn {
    padding: 8px 16px;
    background: transparent;
    border: 1px solid var(--red);
    color: var(--red);
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.3s;
    font-size: 0.85rem;
}

.logout-btn:hover {
    background: rgba(255, 68, 68, 0.1);
}

.char-counter {
    font-size: 0.8rem;
    color: var(--grey);
    margin-top: 5px;
    text-align: left;
}

.char-counter.valid {
    color: var(--green);
}

.char-counter.invalid {
    color: var(--red);
}

.price-badge {
    display: inline-flex;
    align-items: center;
    gap: 5px;
    background: rgba(212, 175, 55, 0.1);
    border: 1px solid var(--gold);
    padding: 6px 12px;
    border-radius: 20px;
    cursor: pointer;
    transition: all 0.3s;
}

.price-badge:hover {
    background: rgba(212, 175, 55, 0.2);
}

.auth-container {
    max-width: 400px;
    margin: 100px auto;
    padding: 20px;
}

.auth-card {
    background: var(--card);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 30px;
}

.auth-title {
    text-align: center;
    color: var(--gold);
    font-size: 1.5rem;
    margin-bottom: 25px;
    font-family: 'Orbitron', sans-serif;
}

.auth-btn {
    width: 100%;
    padding: 14px;
    background: var(--gold);
    color: #000;
    border: none;
    border-radius: 10px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.3s;
    margin-top: 10px;
}

.auth-btn:hover {
    background: #e6c04a;
    box-shadow: 0 0 15px rgba(212, 175, 55, 0.3);
}

@media (max-width: 768px) {
    .header {
        flex-direction: column;
        gap: 15px;
    }
    
    .balance-amount {
        font-size: 2.5rem;
    }
    
    .stat-value {
        font-size: 1.5rem;
    }
    
    .container {
        padding: 15px;
    }
}
</style>
</head>
<body id="body-tag">

<!-- Language Switcher -->
<button class="lang-switch" id="lang-switcher" onclick="toggleLang()">English</button>

<!-- Agreement Page -->
<div class="agreement-page" id="agreementPage">
    <div class="agreement-container">
        <div class="agreement-header">
            <div class="agreement-logo">SARMAD PROTOCOL</div>
            <div class="agreement-subtitle">Ø§ØªÙØ§Ù‚ÙŠØ© Ø´Ø±Ø§Ø¡ Ø¹Ù…Ù„Øª SRMD Ø§Ù„Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©</div>
            <div class="version-badge">v1.2</div>
        </div>

        <!-- Carousel Section - Moved Here -->
        <div class="sarmad-carousel-section">
            <div class="carousel-wrapper">
                <!-- Previous Button -->
                <button class="nav-btn prev-btn" onclick="prevSlide()" aria-label="Previous">â®</button>
                
                <!-- Carousel Container -->
                <div class="carousel-container">
                    <div class="carousel-slide" id="carouselSlide">
                        <img src="https://raw.githubusercontent.com/Mustapha-Sarmad-Protocol/adprotocol.com/refs/heads/main/ai-managed-gateway-core.png" alt="AI-Managed Gateway Core" class="carousel-img" onclick="openLightbox(0)">
                        <img src="https://raw.githubusercontent.com/Mustapha-Sarmad-Protocol/adprotocol.com/refs/heads/main/quantum-fortress-security.png" alt="Quantum Fortress Security" class="carousel-img" onclick="openLightbox(1)">
                        <img src="https://raw.githubusercontent.com/Mustapha-Sarmad-Protocol/adprotocol.com/refs/heads/main/proof-of-utility-vs-waste.png" alt="Proof of Utility vs Waste" class="carousel-img" onclick="openLightbox(2)">
                        <img src="https://raw.githubusercontent.com/Mustapha-Sarmad-Protocol/adprotocol.com/refs/heads/main/frictionless-financial-freedom.png" alt="Frictionless Financial Freedom" class="carousel-img" onclick="openLightbox(3)">
                        <img src="https://raw.githubusercontent.com/Mustapha-Sarmad-Protocol/adprotocol.com/refs/heads/main/protocol-tenure-rewards.png" alt="Protocol Tenure Rewards" class="carousel-img" onclick="openLightbox(4)">
                    </div>
                    
                    <!-- Indicators -->
                    <div class="carousel-indicators" id="carouselIndicators"></div>
                </div>
                
                <!-- Next Button -->
                <button class="nav-btn next-btn" onclick="nextSlide()" aria-label="Next">â¯</button>
            </div>
        </div>

        <!-- Lightbox -->
        <div class="lightbox-overlay" id="lightbox" onclick="closeLightbox()">
            <span class="close-btn">&times;</span>
            <img class="lightbox-content" id="lightboxImg">
        </div>

        <div class="content-card">
            <h2 class="section-title">ğŸ“‹ Ø¨Ù†ÙˆØ¯ Ø§Ù„Ø§ØªÙØ§Ù‚ÙŠØ©</h2>
            <ul class="terms-list">
                <li>
                    <strong>Ø·Ø¨ÙŠØ¹Ø© Ø§Ù„Ù…Ø´Ø±ÙˆØ¹</strong>
                    ÙŠÙÙ‚Ø± Ø§Ù„Ù…Ø³ØªØ«Ù…Ø± Ø¨Ø£Ù† Sarmad Protocol Ù‡Ùˆ Ù…Ø´Ø±ÙˆØ¹ Ø°ÙƒØ§Ø¡ Ø§ØµØ·Ù†Ø§Ø¹ÙŠ Ù…Ø¨Ù†ÙŠ Ø¹Ù„Ù‰ Ø´Ø¨ÙƒØ© Ù„Ø§Ù…Ø±ÙƒØ²ÙŠØ© Ø®Ø§ØµØ©. Ø§Ù„Ø¹Ù…Ù„Ø© (SRMD) Ù‡ÙŠ Ø£Ø¯Ø§Ø© Ø¯ÙØ¹ Ù„Ø§Ø´ØªØ±Ø§ÙƒØ§Øª Ø§Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„Ø«Ù‚ÙŠÙ„Ø© ÙÙ‚Ø·ØŒ ÙˆÙ„ÙŠØ³Øª ÙˆØ±Ù‚Ø© Ù…Ø§Ù„ÙŠØ© Ø£Ùˆ Ø³Ù‡Ù… Ù…Ù„ÙƒÙŠØ©.
                </li>
                <li>
                    <strong>Ù…Ø®Ø§Ø·Ø± Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±</strong>
                    Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙÙŠ Ù…Ø´Ø§Ø±ÙŠØ¹ Ø§Ù„Ø¹Ù…Ù„Ø§Øª Ø§Ù„Ø±Ù‚Ù…ÙŠØ© ÙˆØ§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ ÙŠÙ†Ø·ÙˆÙŠ Ø¹Ù„Ù‰ Ù…Ø®Ø§Ø·Ø± Ø¹Ø§Ù„ÙŠØ©ØŒ Ø¨Ù…Ø§ ÙÙŠ Ø°Ù„Ùƒ ÙÙ‚Ø¯Ø§Ù† Ø±Ø£Ø³ Ø§Ù„Ù…Ø§Ù„ Ø¨Ø§Ù„ÙƒØ§Ù…Ù„.
                </li>
                <li>
                    <strong>Ù„Ø§ Ø¶Ù…Ø§Ù†Ø§Øª Ù…Ø§Ù„ÙŠØ©</strong>
                    Ù„Ø§ ÙŠØ¶Ù…Ù† Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ø£ÙŠ Ø¹ÙˆØ§Ø¦Ø¯ Ø£Ùˆ Ø£Ø±Ø¨Ø§Ø­ Ù…Ø³ØªÙ‚Ø¨Ù„ÙŠØ©. Ù‚ÙŠÙ…Ø© Ø§Ù„Ø¹Ù…Ù„Ø© Ù‚Ø¯ ØªØ±ØªÙØ¹ Ø£Ùˆ ØªÙ†Ø®ÙØ¶ Ø¨Ù†Ø§Ø¡Ù‹ Ø¹Ù„Ù‰ Ø§Ù„Ø³ÙˆÙ‚.
                </li>
                <li>
                    <strong>Ø¢Ù„ÙŠØ© Ø§Ù„Ø´Ø±Ø§Ø¡</strong>
                    ÙŠØªÙ… Ø´Ø±Ø§Ø¡ SRMD Ø¹Ù† Ø·Ø±ÙŠÙ‚ Ø¥Ø±Ø³Ø§Ù„ USDT (TRC20) Ø¥Ù„Ù‰ Ø§Ù„Ù…Ø­ÙØ¸Ø© Ø§Ù„Ù…Ø­Ø¯Ø¯Ø© ÙˆØ¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© (TXID) ÙÙŠ Ø§Ù„Ù†Ø¸Ø§Ù….
                </li>
                <li>
                    <strong>Ø§Ù„ØªØ­Ù‚Ù‚ ÙˆØ§Ù„Ù…ÙˆØ§ÙÙ‚Ø©</strong>
                    ÙŠØªÙ… Ù…Ø±Ø§Ø¬Ø¹Ø© ÙƒÙ„ Ù…Ø¹Ø§Ù…Ù„Ø© ÙŠØ¯ÙˆÙŠÙ‹Ø§. Ù‚Ø¯ ÙŠØ³ØªØºØ±Ù‚ Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† 24 Ø¥Ù„Ù‰ 72 Ø³Ø§Ø¹Ø©.
                </li>
                <li>
                    <strong>Ø³ÙŠØ§Ø³Ø© Ø¹Ø¯Ù… Ø§Ù„Ø§Ø³ØªØ±Ø¯Ø§Ø¯</strong>
                    Ø¬Ù…ÙŠØ¹ Ø¹Ù…Ù„ÙŠØ§Øª Ø§Ù„Ø´Ø±Ø§Ø¡ Ù†Ù‡Ø§Ø¦ÙŠØ© ÙˆÙ„Ø§ ÙŠÙ…ÙƒÙ† Ø§Ø³ØªØ±Ø¯Ø§Ø¯Ù‡Ø§. ØªØ£ÙƒØ¯ Ù…Ù† Ù‚Ø±Ø§Ø±Ùƒ Ù‚Ø¨Ù„ Ø§Ù„Ø¥Ø±Ø³Ø§Ù„.
                </li>
                <li>
                    <strong>Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ø§Ù„Ù‚Ø§Ù†ÙˆÙ†ÙŠ</strong>
                    Ø§Ù„Ù…Ø³ØªØ«Ù…Ø± Ù…Ø³Ø¤ÙˆÙ„ Ø¹Ù† Ø§Ù„Ø§Ù…ØªØ«Ø§Ù„ Ù„Ù„Ù‚ÙˆØ§Ù†ÙŠÙ† Ø§Ù„Ù…Ø­Ù„ÙŠØ© ÙÙŠ Ø¨Ù„Ø¯Ù‡. Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ Ù„Ø§ ÙŠÙ‚Ø¯Ù… Ø§Ø³ØªØ´Ø§Ø±Ø§Øª Ù‚Ø§Ù†ÙˆÙ†ÙŠØ© Ø£Ùˆ Ù…Ø§Ù„ÙŠØ©.
                </li>
                <li>
                    <strong>Ø­Ù…Ø§ÙŠØ© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª</strong>
                    ÙŠØªÙ… Ø¬Ù…Ø¹ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙÙ‚Ø· Ù„Ù„Ù…ØµØ§Ø¯Ù‚Ø© ÙˆØ§Ù„Ø£Ù…Ø§Ù†. Ù„Ù† ÙŠØªÙ… Ù…Ø´Ø§Ø±ÙƒØ© Ø¨ÙŠØ§Ù†Ø§ØªÙƒ Ù…Ø¹ Ø£Ø·Ø±Ø§Ù Ø«Ø§Ù„Ø«Ø©.
                </li>
            </ul>
        </div>

        <div class="highlight-box">
            <div class="highlight-title">âš ï¸ ØªØ­Ø°ÙŠØ± Ù…Ù‡Ù…</div>
            <p>Ù‡Ø°Ø§ Ø§Ù„Ù…Ø´Ø±ÙˆØ¹ ÙÙŠ Ù…Ø±Ø§Ø­Ù„ Ø§Ù„ØªØ·ÙˆÙŠØ± Ø§Ù„Ù…Ø¨ÙƒØ±Ø©. Ù‚Ø¯ ØªØ­Ø¯Ø« ØªØºÙŠÙŠØ±Ø§Øª Ø¬Ø°Ø±ÙŠØ© ÙÙŠ Ø§Ù„Ø®Ø·Ø© Ø£Ùˆ Ø§Ù„ØªÙˆÙ‚ÙŠØª Ø£Ùˆ Ø§Ù„Ø¢Ù„ÙŠØ§Øª Ø§Ù„ØªÙ‚Ù†ÙŠØ©. Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø± ÙŠØ¹Ù†ÙŠ Ù‚Ø¨ÙˆÙ„Ùƒ Ù„Ù‡Ø°Ù‡ Ø§Ù„Ù…Ø®Ø§Ø·Ø±.</p>
        </div>

        <div class="agree-section">
            <label class="checkbox-container">
                <input type="checkbox" id="agreeCheckbox">
                <span class="checkbox-text">
                    <strong>Ø£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø¨Ù†ÙˆØ¯ Ø£Ø¹Ù„Ø§Ù‡</strong><br>
                    Ø£Ù‚Ø± Ø¨Ø£Ù†Ù†ÙŠ Ù‚Ø±Ø£Øª ÙˆÙÙ‡Ù…Øª Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø´Ø±ÙˆØ· ÙˆØ§Ù„Ù…Ø®Ø§Ø·Ø±ØŒ ÙˆØ£ÙˆØ§ÙÙ‚ Ø¹Ù„Ù‰ Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¹Ù„Ù‰ Ù…Ø³Ø¤ÙˆÙ„ÙŠØªÙŠ Ø§Ù„Ø®Ø§ØµØ©.
                </span>
            </label>
        </div>

        <button class="agreement-btn" id="proceedBtn" disabled onclick="proceedToApp()">
            Ø§Ù„Ù…ØªØ§Ø¨Ø¹Ø© Ø¥Ù„Ù‰ Ø§Ù„ØªØ·Ø¨ÙŠÙ‚ â†’
        </button>
    </div>
</div>

<!-- Wallet App -->
<div class="wallet-app" id="walletApp">
    <!-- Auth UI -->
    <div id="auth-ui">
        <div class="auth-container">
            <div class="auth-card">
                <div class="auth-title" id="t-login-title">ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„</div>
                <div class="input-group">
                    <label>Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ (Ù…Ø¹ Ø±Ù…Ø² Ø§Ù„Ø¯ÙˆÙ„Ø©)</label>
                    <input type="tel" id="phone" placeholder="+9647xxxxxxxxx">
                </div>
                <button class="auth-btn" id="t-send-otp" onclick="sendOTP()">Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚</button>
                <div id="recaptcha-container"></div>
                <div class="input-group hidden" id="otp-area">
                    <label>Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚ (OTP)</label>
                    <input type="text" id="otp" placeholder="123456">
                    <button class="auth-btn" id="t-verify-otp" onclick="verifyOTP()">ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù…Ø²</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Main UI -->
    <div id="main-ui" class="hidden">
        <div class="header">
            <div class="logo-section">
                <div class="logo-text">SARMAD</div>
                <div class="version-badge">v1.2</div>
            </div>
            <div class="user-section">
                <span id="header-user">User</span>
                <div class="user-icon">ğŸ‘¤</div>
                <button class="logout-btn" id="t-logout" onclick="handleLogout()">ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬</button>
            </div>
        </div>

        <div class="container">
            <!-- Global Stats -->
            <div class="stats-grid">
                <div class="stat-card">
                    <div class="stat-value" id="global-investors-count">0</div>
                    <div class="stat-label" id="t-total-investors-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†</div>
                </div>
                <div class="stat-card">
                    <div class="stat-value" id="global-srmd-count">0</div>
                    <div class="stat-label" id="t-total-coins-label">Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ù…Ù„Ø§Øª SRMD</div>
                </div>
            </div>

            <!-- Balance Card -->
            <div class="card">
                <h3 class="card-title" id="t-balance-label">Ø±ØµÙŠØ¯ÙŠ Ù…Ù† SRMD</h3>
                <div class="balance-display">
                    <div class="balance-amount" id="total-balance">0.00</div>
                    <div class="balance-label">SRMD</div>
                    <div class="usd-value">
                        <span id="t-usd-label">â‰ˆ $</span>
                        <span id="total-usd">0.00</span>
                    </div>
                </div>
                <div class="price-badge" onclick="showPriceInfo()">
                    ğŸ’° Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ: $<span id="current-price">0.00</span>
                </div>
            </div>

            <!-- Deposit Instructions -->
            <div class="card">
                <h3 class="card-title" id="t-deposit-title">Ø¥ÙŠØ¯Ø§Ø¹ USDT</h3>
                <div class="info-box">
                    <p id="t-copy-hint">â¬‡ï¸ Ø§Ù†Ø³Ø® Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ£Ø±Ø³Ù„ USDT (TRC20) ÙÙ‚Ø·</p>
                </div>
                <div class="wallet-address">TH9uvbgRL4gG2Ad3255hWTHco6jQt13G6N</div>
                <button class="copy-btn" onclick="copyWallet()">ğŸ“‹ Ù†Ø³Ø® Ø§Ù„Ø¹Ù†ÙˆØ§Ù†</button>
            </div>

            <!-- Submit Transaction -->
            <div class="card">
                <h3 class="card-title" id="t-buy-title">ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø´Ø±Ø§Ø¡</h3>
                <div class="input-group">
                    <label id="t-txid-hint">Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© (TXID) - ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 64 Ø­Ø±Ù Ø¨Ø§Ù„Ø¶Ø¨Ø·</label>
                    <input 
                        type="text" 
                        id="txid-input" 
                        placeholder="a1b2c3d4e5f6..." 
                        maxlength="64"
                        oninput="checkTxLength()"
                    >
                    <div class="char-counter" id="char-counter">0/64 characters</div>
                </div>
                <button class="submit-btn" id="t-submit-btn" onclick="submitNewRequest()" disabled>
                    Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨
                </button>
            </div>

            <!-- Transaction History -->
            <div class="card">
                <h3 class="card-title" id="t-history-title">Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª</h3>
                <button class="refresh-btn" id="t-refresh-btn" onclick="loadInvestorData(true)">
                    ğŸ”„ ØªØ­Ø¯ÙŠØ«
                </button>
                <table class="history-table" id="history-table">
                    <thead>
                        <tr>
                            <th>TXID</th>
                            <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
                        </tr>
                    </thead>
                    <tbody id="history-body"></tbody>
                </table>
                <div class="empty-state hidden" id="empty-history">
                    <p>Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø¨Ø¹Ø¯</p>
                    <small>Ù‚Ù… Ø¨Ø¥Ø±Ø³Ø§Ù„ USDT ÙˆØ¥Ø¯Ø®Ø§Ù„ TXID Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±</small>
                </div>
            </div>
        </div>
    </div>
</div>

<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>

<script>
// ===== Enhanced Carousel Functionality =====
let currentSlideIndex = 0;
const slides = document.querySelectorAll('.carousel-img');
const totalSlides = slides.length;
let autoSlideInterval;
const SLIDE_INTERVAL = 4000;

function createIndicators() {
    const indicatorsContainer = document.getElementById('carouselIndicators');
    for (let i = 0; i < totalSlides; i++) {
        const dot = document.createElement('div');
        dot.className = 'indicator-dot';
        if (i === 0) dot.classList.add('active');
        dot.onclick = () => goToSlide(i);
        indicatorsContainer.appendChild(dot);
    }
}

function updateIndicators() {
    const dots = document.querySelectorAll('.indicator-dot');
    dots.forEach((dot, index) => {
        dot.classList.toggle('active', index === currentSlideIndex);
    });
}

function goToSlide(index) {
    currentSlideIndex = index;
    updateCarousel();
    resetAutoSlide();
}

function updateCarousel() {
    const slideContainer = document.getElementById('carouselSlide');
    const offset = -currentSlideIndex * 100;
    slideContainer.style.transform = `translateX(${offset}%)`;
    updateIndicators();
}

function nextSlide() {
    currentSlideIndex = (currentSlideIndex + 1) % totalSlides;
    updateCarousel();
    resetAutoSlide();
}

function prevSlide() {
    currentSlideIndex = (currentSlideIndex - 1 + totalSlides) % totalSlides;
    updateCarousel();
    resetAutoSlide();
}

function startAutoSlide() {
    autoSlideInterval = setInterval(nextSlide, SLIDE_INTERVAL);
}

function resetAutoSlide() {
    clearInterval(autoSlideInterval);
    startAutoSlide();
}

const carouselContainer = document.querySelector('.carousel-container');
carouselContainer.addEventListener('mouseenter', () => {
    clearInterval(autoSlideInterval);
});

carouselContainer.addEventListener('mouseleave', () => {
    startAutoSlide();
});

const lightbox = document.getElementById('lightbox');
const lightboxImg = document.getElementById('lightboxImg');
const imageUrls = [
    'https://raw.githubusercontent.com/Mustapha-Sarmad-Protocol/adprotocol.com/refs/heads/main/ai-managed-gateway-core.png',
    'https://raw.githubusercontent.com/Mustapha-Sarmad-Protocol/adprotocol.com/refs/heads/main/quantum-fortress-security.png',
    'https://raw.githubusercontent.com/Mustapha-Sarmad-Protocol/adprotocol.com/refs/heads/main/proof-of-utility-vs-waste.png',
    'https://raw.githubusercontent.com/Mustapha-Sarmad-Protocol/adprotocol.com/refs/heads/main/frictionless-financial-freedom.png',
    'https://raw.githubusercontent.com/Mustapha-Sarmad-Protocol/adprotocol.com/refs/heads/main/protocol-tenure-rewards.png'
];

function openLightbox(index) {
    lightboxImg.src = imageUrls[index];
    lightbox.style.display = 'flex';
    document.body.style.overflow = 'hidden';
}

function closeLightbox() {
    lightbox.style.display = 'none';
    document.body.style.overflow = 'auto';
}

document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape' && lightbox.style.display === 'flex') {
        closeLightbox();
    }
});

lightboxImg.addEventListener('click', (e) => {
    e.stopPropagation();
});

document.addEventListener('DOMContentLoaded', () => {
    createIndicators();
    updateCarousel();
    startAutoSlide();
});

// ===== Firebase Configuration =====
const firebaseConfig = {
    apiKey: "AIzaSyDWy8uqAX0Jg6I0Q75D_5r3UYWcq2fMMdo",
    authDomain: "sarmad-b6d54.firebaseapp.com",
    projectId: "sarmad-b6d54",
    storageBucket: "sarmad-b6d54.firebasestorage.app",
    messagingSenderId: "1043316768034",
    appId: "1:1043316768034:web:72b94f2b067edbcdf30dd2"
};

firebase.initializeApp(firebaseConfig);
const auth = firebase.auth();
const db = firebase.firestore();

let confirmationResult;
let srmdPrice = 0;
let currentLang = 'ar';

const langData = {
    ar: {
        switcher: 'English',
        loginTitle: 'ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„',
        sendOtp: 'Ø¥Ø±Ø³Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚',
        verifyOtp: 'ØªØ£ÙƒÙŠØ¯ Ø§Ù„Ø±Ù…Ø²',
        depositTitle: 'Ø¥ÙŠØ¯Ø§Ø¹ USDT',
        copyHint: 'â¬‡ï¸ Ø§Ù†Ø³Ø® Ø§Ù„Ø¹Ù†ÙˆØ§Ù† ÙˆØ£Ø±Ø³Ù„ USDT (TRC20) ÙÙ‚Ø·',
        balanceLabel: 'Ø±ØµÙŠØ¯ÙŠ Ù…Ù† SRMD',
        usdLabel: 'â‰ˆ $',
        buyTitle: 'ØªÙ‚Ø¯ÙŠÙ… Ø·Ù„Ø¨ Ø´Ø±Ø§Ø¡',
        submitBtn: 'Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø·Ù„Ø¨',
        historyTitle: 'Ø³Ø¬Ù„ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø§Øª',
        refresh: 'ğŸ”„ ØªØ­Ø¯ÙŠØ«',
        logout: 'ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬',
        totalCoins: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø¹Ù…Ù„Ø§Øª SRMD',
        totalInvestors: 'Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…Ø³ØªØ«Ù…Ø±ÙŠÙ†',
        txidHint: 'Ø£Ø¯Ø®Ù„ Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© (TXID) - ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 64 Ø­Ø±Ù Ø¨Ø§Ù„Ø¶Ø¨Ø·',
        pending: 'Ù‚ÙŠØ¯ Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø©',
        approved: 'ØªÙ…Øª Ø§Ù„Ù…ÙˆØ§ÙÙ‚Ø©',
        rejected: 'Ù…Ø±ÙÙˆØ¶',
        invalid_txid: 'TXID ØºÙŠØ± ØµØ§Ù„Ø­',
        already_used: 'ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ TXID Ù…Ø³Ø¨Ù‚Ø§Ù‹',
        no_transaction: 'Ù„Ù… ÙŠØªÙ… Ø§Ù„Ø¹Ø«ÙˆØ± Ø¹Ù„Ù‰ Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø©',
        noHistory: 'Ù„Ø§ ØªÙˆØ¬Ø¯ Ù…Ø¹Ø§Ù…Ù„Ø§Øª Ø¨Ø¹Ø¯',
        noHistoryDesc: 'Ù‚Ù… Ø¨Ø¥Ø±Ø³Ø§Ù„ USDT ÙˆØ¥Ø¯Ø®Ø§Ù„ TXID Ù„Ø¨Ø¯Ø¡ Ø§Ù„Ø§Ø³ØªØ«Ù…Ø§Ø±',
        enterPhone: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ù‡Ø§ØªÙ ØµØ§Ù„Ø­',
        enterOtp: 'Ø§Ù„Ø±Ø¬Ø§Ø¡ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù…Ø² Ø§Ù„ØªØ­Ù‚Ù‚',
        txidInvalid: 'Ø±Ù‚Ù… Ø§Ù„Ù…Ø¹Ø§Ù…Ù„Ø© ÙŠØ¬Ø¨ Ø£Ù† ÙŠÙƒÙˆÙ† 64 Ø­Ø±Ù Ø¨Ø§Ù„Ø¶Ø¨Ø·',
        txidUsed: 'ØªÙ… Ø§Ø³ØªØ®Ø¯Ø§Ù… Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… Ù…Ø³Ø¨Ù‚Ø§Ù‹',
        txidSuccess: 'ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø·Ù„Ø¨Ùƒ Ø¨Ù†Ø¬Ø§Ø­! Ø³ÙŠØªÙ… Ø§Ù„Ù…Ø±Ø§Ø¬Ø¹Ø© Ø®Ù„Ø§Ù„ 24-72 Ø³Ø§Ø¹Ø©',
        copied: 'ØªÙ… Ø§Ù„Ù†Ø³Ø®!',
        priceMsg: 'Ø§Ù„Ø³Ø¹Ø± Ø§Ù„Ø­Ø§Ù„ÙŠ Ù„Ù€ SRMD ÙŠØªÙ… ØªØ­Ø¯ÙŠØ«Ù‡ ØªÙ„Ù‚Ø§Ø¦ÙŠØ§Ù‹ Ù…Ù† Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª'
    },
    en: {
        switcher: 'Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©',
        loginTitle: 'Login',
        sendOtp: 'Send OTP',
        verifyOtp: 'Verify Code',
        depositTitle: 'Deposit USDT',
        copyHint: 'â¬‡ï¸ Copy address and send USDT (TRC20) only',
        balanceLabel: 'My SRMD Balance',
        usdLabel: 'â‰ˆ $',
        buyTitle: 'Submit Purchase Request',
        submitBtn: 'Submit Request',
        historyTitle: 'Transaction History',
        refresh: 'ğŸ”„ Refresh',
        logout: 'Logout',
        totalCoins: 'Total SRMD Coins',
        totalInvestors: 'Total Investors',
        txidHint: 'Enter Transaction ID (TXID) - Must be exactly 64 characters',
        pending: 'Under Review',
        approved: 'Approved',
        rejected: 'Rejected',
        invalid_txid: 'Invalid TXID',
        already_used: 'This TXID was already used',
        no_transaction: 'Transaction not found',
        noHistory: 'No transactions yet',
        noHistoryDesc: 'Send USDT and enter TXID to start investing',
        enterPhone: 'Please enter a valid phone number',
        enterOtp: 'Please enter verification code',
        txidInvalid: 'Transaction ID must be exactly 64 characters',
        txidUsed: 'This TXID has already been used',
        txidSuccess: 'Request submitted successfully! Will be reviewed within 24-72 hours',
        copied: 'Copied!',
        priceMsg: 'Current SRMD price is updated automatically from database'
    }
};

document.getElementById('agreeCheckbox').addEventListener('change', function() {
    document.getElementById('proceedBtn').disabled = !this.checked;
});

window.proceedToApp = function() {
    const agreed = document.getElementById('agreeCheckbox').checked;
    if (agreed) {
        document.getElementById('agreementPage').style.display = 'none';
        document.getElementById('walletApp').style.display = 'block';
        document.getElementById('walletApp').classList.remove('wallet-app');
        initWallet();
    }
};

function initWallet() {
    auth.onAuthStateChanged(user => {
        if (user) {
            document.getElementById('auth-ui').classList.add('hidden');
            document.getElementById('main-ui').classList.remove('hidden');
            document.getElementById('header-user').innerText = user.phoneNumber || "User";
            
            db.collection('settings').doc('prices').onSnapshot(snap => {
                if (snap.exists) {
                    const data = snap.data();
                    srmdPrice = data && data.srmd_price ? data.srmd_price : 0;
                    document.getElementById('current-price').innerText = srmdPrice.toFixed(2);
                    updateTotalUSD();
                }
            });
            
            db.collection('investors').onSnapshot(snap => {
                let totalCoins = 0;
                document.getElementById('global-investors-count').innerText = snap.size;
                snap.forEach(doc => {
                    const d = doc.data();
                    if(d && d.balance) {
                        totalCoins += d.balance;
                    }
                });
                document.getElementById('global-srmd-count').innerText = totalCoins.toLocaleString();
            });
            
            loadInvestorData();
        }
    });
}

function startCooldown(id, text) {
    const b = document.getElementById(id);
    if (!b) return;
    b.disabled = true;
    let c = 10;
    const timer = setInterval(() => {
        b.innerText = c + "s";
        c--;
        if (c < 0) {
            clearInterval(timer);
            b.disabled = false;
            b.innerText = text;
        }
    }, 1000);
}

function toggleLang() {
    currentLang = currentLang === 'en' ? 'ar' : 'en';
    document.getElementById('main-html').dir = currentLang === 'ar' ? 'rtl' : 'ltr';
    document.getElementById('body-tag').className = currentLang === 'ar' ? 'ar-mode' : '';
    
    const elements = {
        'lang-switcher': 'switcher',
        't-login-title': 'loginTitle',
        't-send-otp': 'sendOtp',
        't-verify-otp': 'verifyOtp',
        't-deposit-title': 'depositTitle',
        't-copy-hint': 'copyHint',
        't-balance-label': 'balanceLabel',
        't-usd-label': 'usdLabel',
        't-buy-title': 'buyTitle',
        't-submit-btn': 'submitBtn',
        't-history-title': 'historyTitle',
        't-refresh-btn': 'refresh',
        't-logout': 'logout',
        't-total-coins-label': 'totalCoins',
        't-total-investors-label': 'totalInvestors',
        't-txid-hint': 'txidHint'
    };
    
    Object.keys(elements).forEach(id => {
        const el = document.getElementById(id);
        if (el && langData[currentLang][elements[id]]) {
            el.innerText = langData[currentLang][elements[id]];
        }
    });
    
    const emptyHistory = document.getElementById('empty-history');
    if (emptyHistory && !emptyHistory.classList.contains('hidden')) {
        emptyHistory.innerHTML = `
            <p>${langData[currentLang].noHistory}</p>
            <small>${langData[currentLang].noHistoryDesc}</small>
        `;
    }
    
    if (auth.currentUser) {
        loadInvestorData();
    }
}

function showPriceInfo() {
    alert(langData[currentLang].priceMsg);
}

function copyWallet() {
    const wallet = "TH9uvbgRL4gG2Ad3255hWTHco6jQt13G6N";
    navigator.clipboard.writeText(wallet)
        .then(() => alert(langData[currentLang].copied))
        .catch(err => console.error('Copy failed:', err));
}

function handleLogout() {
    if (confirm('Are you sure you want to logout?')) {
        auth.signOut().then(() => location.reload());
    }
}

function checkTxLength() {
    const txInput = document.getElementById('txid-input');
    const btn = document.getElementById('t-submit-btn');
    const counter = document.getElementById('char-counter');
    const length = txInput.value.trim().length;
    
    counter.innerText = `${length}/64 characters`;
    
    if (length === 64) {
        btn.disabled = false;
        btn.style.opacity = "1";
        counter.classList.add('valid');
        counter.classList.remove('invalid');
    } else {
        btn.disabled = true;
        btn.style.opacity = "0.6";
        counter.classList.remove('valid');
        if (length > 0) {
            counter.classList.add('invalid');
        } else {
            counter.classList.remove('invalid');
        }
    }
}

async function sendOTP() {
    const p = document.getElementById('phone').value.trim();
    if (!p || !p.startsWith('+')) {
        alert(langData[currentLang].enterPhone);
        return;
    }
    
    try {
        if (!window.recaptchaVerifier) {
            window.recaptchaVerifier = new firebase.auth.RecaptchaVerifier('recaptcha-container', {
                size: 'invisible'
            });
        }
        confirmationResult = await auth.signInWithPhoneNumber(p, window.recaptchaVerifier);
        document.getElementById('otp-area').classList.remove('hidden');
        document.getElementById('t-send-otp').classList.add('hidden');
        document.getElementById('otp').focus();
    } catch (err) {
        alert('Error: ' + err.message);
        console.error(err);
        if (window.recaptchaVerifier) {
            window.recaptchaVerifier.clear();
            window.recaptchaVerifier = null;
        }
    }
}

function verifyOTP() {
    const code = document.getElementById('otp').value.trim();
    if (!code) {
        alert(langData[currentLang].enterOtp);
        return;
    }
    confirmationResult.confirm(code)
        .then(() => location.reload())
        .catch(err => {
            alert('Invalid OTP code');
            console.error(err);
        });
}

function updateTotalUSD() {
    const bal = parseFloat(document.getElementById('total-balance').innerText) || 0;
    document.getElementById('total-usd').innerText = (bal * srmdPrice).toFixed(2);
}

function loadInvestorData(isManual = false) {
    if (!auth.currentUser) return;
    if (isManual) startCooldown('t-refresh-btn', langData[currentLang].refresh);
    
    db.collection('investors').doc(auth.currentUser.phoneNumber).get().then(doc => {
        if (doc.exists) {
            const data = doc.data();
            const bal = data.balance || 0;
            
            document.getElementById('total-balance').innerText = bal.toFixed(2);
            updateTotalUSD();
            
            const requests = data.requests || [];
            const body = document.getElementById('history-body');
            const table = document.getElementById('history-table');
            const emptyState = document.getElementById('empty-history');
            
            body.innerHTML = '';
            
            if (requests.length === 0) {
                table.classList.add('hidden');
                emptyState.classList.remove('hidden');
            } else {
                table.classList.remove('hidden');
                emptyState.classList.add('hidden');
                
                let rowsHtml = '';
                requests.slice().reverse().forEach(req => {
                    if (!req) return;
                    const statusText = langData[currentLang][req.status] || req.status;
                    const reasonText = req.reasonCode ? (langData[currentLang][req.reasonCode] || req.reasonCode) : "";
                    const txStr = req.txid || "UNKNOWN";
                    const txidPreview = txStr.length > 10 
                        ? txStr.substring(0, 8) + '...' + txStr.substring(txStr.length - 6) 
                        : txStr;
                    
                    rowsHtml += `
                        <tr>
                            <td style="text-align:left;">
                                <span class="txid-preview" title="${txStr}">${txidPreview}</span>
                            </td>
                            <td class="st-${req.status}">
                                ${statusText}
                                ${reasonText ? `<small class="reason-text">${reasonText}</small>` : ''}
                            </td>
                        </tr>
                    `;
                });
                body.innerHTML = rowsHtml;
            }
        } else {
            db.collection('investors').doc(auth.currentUser.phoneNumber).set({
                balance: 0,
                requests: [],
                created_at: firebase.firestore.FieldValue.serverTimestamp()
            });
        }
    }).catch(err => {
        console.error('Error loading data:', err);
    });
}

async function submitNewRequest() {
    const tx = document.getElementById('txid-input').value.trim();
    if (tx.length !== 64) {
        alert(langData[currentLang].txidInvalid);
        return;
    }
    startCooldown('t-submit-btn', langData[currentLang].submitBtn);
    
    try {
        const txCheck = await db.collection('all_txids').doc(tx).get();
        if (txCheck.exists) {
            alert(langData[currentLang].txidUsed);
            return;
        }
        
        const batch = db.batch();
        batch.set(db.collection('all_txids').doc(tx), {
            used_by: auth.currentUser.phoneNumber,
            timestamp: firebase.firestore.FieldValue.serverTimestamp()
        });
        batch.set(
            db.collection('investors').doc(auth.currentUser.phoneNumber),
            {
                requests: firebase.firestore.FieldValue.arrayUnion({
                    txid: tx,
                    status: 'pending',
                    timestamp: new Date()
                })
            },
            { merge: true }
        );
        
        await batch.commit();
        alert(langData[currentLang].txidSuccess);
        document.getElementById('txid-input').value = '';
        checkTxLength();
        loadInvestorData();
    } catch (err) {
        alert('Error: ' + err.message);
        console.error(err);
    }
}
</script>
</body>
</html>
